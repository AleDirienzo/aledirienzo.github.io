<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Max Ricci - Portofolio 2025</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav>
        <div class="logo">Max Ricci</div>
        <ul class="nav-links">
            <li><a href="#work">Work</a></li>
            <li><a href="about.html">About Max</a></li>
            <li><a href="contact.html">Contact</a></li>
        </ul>
    </nav>

    <section class="hero">
        <h1>PERSONAL PORTFOLIO<br>INDUSTRIAL DESIGN<br>2025-2026</h1>
        <div class="subtitle">Portfolio 2025</div>
        <div class="hero-meta">
            <div>
                <span>Based in</span>
                Lugano, CH
            </div>
            <div>
                <span>Discipline</span>
                Design / Art
            </div>
            <div>
                <span>Status</span>
                Available
            </div>
        </div>
    </section>

    <section class="projects-section" id="work">
        <div class="section-header">
            <h2 class="section-title">Selected Works</h2>
            <div class="section-number">[03]</div>
        </div>
        
        <div class="projects-list">
            <div class="project-item">
                <div class="project-number">[01]</div>
                <div class="project-title">THREE O' CLOCK</div>
                <div class="project-description">Time & Perception</div>
                <div class="project-year">2025</div>
            </div>

            <div class="project-item">
                <div class="project-number">[02]</div>
                <div class="project-title">ARCH-ITECTURE</div>
                <div class="project-description">Spatial Forms</div>
                <div class="project-year">2025</div>
            </div>

            <div class="project-item">
                <div class="project-number">[03]</div>
                <div class="project-title">MOI</div>
                <div class="project-description">Visual Diary</div>
                <div class="project-year">2025</div>
            </div>
        </div>
    </section>

    <section class="other-projects-section">
        <div class="section-header">
            <h2 class="section-title">Other Projects</h2>
            <div class="section-number">[â€”]</div>
        </div>
        <div class="other-grid">
            <div class="other-project-card">
                <img src="images/other-01.jpg" alt="Other Project 1">
                <div class="card-caption">Other 01</div>
            </div>
            <div class="other-project-card">
                <img src="images/other-02.jpg" alt="Other Project 2">
                <div class="card-caption">Other 02</div>
            </div>
            <div class="other-project-card">
                <img src="images/other-03.jpg" alt="Other Project 3">
                <div class="card-caption">Other 03</div>
            </div>
            <div class="other-project-card">
                <img src="images/other-04.jpg" alt="Other Project 4">
                <div class="card-caption">Other 04</div>
            </div>
        </div>
    </section>

    <div class="project-visual" id="projectVisual"></div>

    <!-- Project modal (hidden until opened) -->
    <div class="modal-overlay" id="projectModal">
        <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle"></div>
                <button class="modal-close" id="modalClose" aria-label="Close">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="carousel" id="modalCarousel">
                    <button class="nav prev" id="carouselPrev">â€¹</button>
                    <img id="carouselImage" src="" alt="Project image">
                    <button class="nav next" id="carouselNext">â€º</button>
                    <div class="carousel-empty" id="carouselEmpty" style="display:none;color:#888;">Images will be added later.</div>
                    <div class="thumbnails" id="carouselThumbs" aria-hidden="true"></div>
                </div>
                <aside class="modal-side">
                    <div class="desc" id="modalDesc"></div>
                </aside>
            </div>
            <div class="modal-footer" id="modalFooter">Project details</div>
        </div>
    </div>

    <script>
        (function(){
            const projects = document.querySelectorAll('.project-item');
            const visual = document.getElementById('projectVisual');

            // Basic hover preview (keeps previous behavior)
            projects.forEach((project, i) => {
                project.addEventListener('mouseenter', () => {
                    if (window.innerWidth > 1024) {
                        visual.style.opacity = '1';
                        const icons = ['ðŸ•’', 'ðŸ›ï¸', 'âœ¨'];
                        visual.textContent = icons[i] || '';
                    }
                });

                project.addEventListener('mouseleave', () => {
                    visual.style.opacity = '0';
                });

                project.addEventListener('click', () => openProjectModal(i));
            });

            // Project data (titles/descriptions from DOM for reliability)
            const projectData = Array.from(projects).map((el, i) => ({
                index: i,
                title: el.querySelector('.project-title')?.textContent || ('Project ' + (i+1)),
                description: el.querySelector('.project-description')?.textContent || '',
                // image prefix to look for in /images â€” convention: project-01-1.jpg
                imagePrefix: `project-${String(i+1).padStart(2,'0')}`
            }));

            // Modal elements
            const modalOverlay = document.getElementById('projectModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalDesc = document.getElementById('modalDesc');
            const modalClose = document.getElementById('modalClose');
            const modalFooter = document.getElementById('modalFooter');
            const carouselImage = document.getElementById('carouselImage');
            const carouselEmpty = document.getElementById('carouselEmpty');
            const carouselThumbs = document.getElementById('carouselThumbs');
            const prevBtn = document.getElementById('carouselPrev');
            const nextBtn = document.getElementById('carouselNext');

            if (!modalOverlay || !modalTitle) {
                console.error('Modal elements not found â€” modal markup may be missing');
            }

            let currentImages = [];
            let currentIndex = 0;

            function openProjectModal(i){
                try {
                    const data = projectData[i];
                    if (!modalTitle || !modalOverlay) throw new Error('Modal missing');
                    modalTitle.textContent = data.title;
                    modalDesc.textContent = data.description;
                    modalFooter.textContent = `${data.title} â€¢ ${data.index+1}`;
                    modalOverlay.classList.add('active');
                    // try load images matching prefix, up to 6
                    loadImagesForProject(data.imagePrefix, 6, (imgs) => {
                        currentImages = imgs;
                        currentIndex = 0;
                        if (currentImages.length){
                            if (carouselEmpty) carouselEmpty.style.display = 'none';
                            if (carouselImage) { carouselImage.style.display = ''; carouselImage.src = currentImages[0]; }
                            populateThumbnails(currentImages);
                        } else {
                            if (carouselImage) carouselImage.style.display = 'none';
                            if (carouselEmpty) carouselEmpty.style.display = '';
                            clearThumbnails();
                        }
                    });
                    if (modalClose) modalClose.focus();
                } catch (err) {
                    console.error('Failed to open project modal', err);
                }
            }

            function closeModal(){
                if (!modalOverlay) return;
                modalOverlay.classList.remove('active');
                if (carouselImage) carouselImage.src = '';
                currentImages = [];
            }

            if (modalClose) modalClose.addEventListener('click', closeModal);
            if (modalOverlay) modalOverlay.addEventListener('click', (e)=>{
                if (e.target === modalOverlay) closeModal();
            });

            // keyboard support
            document.addEventListener('keydown', (e)=>{
                if (!modalOverlay || !modalOverlay.classList.contains('active')) return;
                if (e.key === 'Escape') closeModal();
                if (e.key === 'ArrowLeft') showPrev();
                if (e.key === 'ArrowRight') showNext();
            });

            if (prevBtn) prevBtn.addEventListener('click', showPrev);
            if (nextBtn) nextBtn.addEventListener('click', showNext);

            function showPrev(){
                if (!currentImages.length || !carouselImage) return;
                currentIndex = (currentIndex - 1 + currentImages.length) % currentImages.length;
                carouselImage.src = currentImages[currentIndex];
            }

            function showNext(){
                if (!currentImages.length || !carouselImage) return;
                currentIndex = (currentIndex + 1) % currentImages.length;
                carouselImage.src = currentImages[currentIndex];
                highlightActiveThumb();
            }

            // Attempt to load images with a naming convention: images/{prefix}-{n}.jpg
            function loadImagesForProject(prefix, maxCount, cb){
                const loaded = [];
                const ext = ['jpg','png'];
                function tryNext(n){
                    if (n > maxCount){
                        cb(loaded);
                        return;
                    }
                    let extIndex = 0;
                    function tryExt(){
                        if (extIndex >= ext.length){
                            tryNext(n+1);
                            return;
                        }
                        const url = `images/${prefix}-${n}.${ext[extIndex]}`;
                        const img = new Image();
                        img.onload = ()=>{ loaded.push(url); tryNext(n+1); };
                        img.onerror = ()=>{ extIndex++; tryExt(); };
                        img.src = url;
                    }
                    tryExt();
                }
                tryNext(1);
            }

            function populateThumbnails(urls){
                clearThumbnails();
                if (!carouselThumbs) return;
                urls.forEach((u, idx) => {
                    const t = document.createElement('img');
                    t.src = u;
                    t.alt = `Thumbnail ${idx+1}`;
                    t.className = 'thumb';
                    t.addEventListener('click', (e)=>{
                        currentIndex = idx;
                        if (carouselImage) carouselImage.src = currentImages[currentIndex];
                        highlightActiveThumb();
                    });
                    carouselThumbs.appendChild(t);
                });
                highlightActiveThumb();
            }

            function clearThumbnails(){
                if (!carouselThumbs) return;
                carouselThumbs.innerHTML = '';
            }

            function highlightActiveThumb(){
                if (!carouselThumbs) return;
                const thumbs = carouselThumbs.querySelectorAll('.thumb');
                thumbs.forEach((t,i)=> t.classList.toggle('active-thumb', i===currentIndex));
            }
        })();
    </script>
    <footer class="footer">
        <div>Â© 2025 Max Ricci</div>
        <div>Lugano, Switzerland</div>
    </footer>

</body>
</html>
